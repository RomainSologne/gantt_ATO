<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Gantt Plotly + ArcGIS REST</title>

  <!-- Plotly sans AMD (obligatoire ! ) -->
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
</head>

<body>

  <div id="chart" style="width:100%;height:600px;"></div>

  <script>
    async function loadData() {
      const url = "https://services.arcgis.com/d3voDfTFbHOCRwVR/arcgis/rest/services/survey123_52a2c2c243354b4bbe1285638d3e41ba/FeatureServer/0/query?where=1%3D1&outFields=d_but_de_lactivit,fin_de_lactivit,unit&f=json";

      const response = await fetch(url);
      const data = await response.json();

      const features = data.features.map(f => f.attributes);

      const tasks = features.map(f => ({
        Task: f.unit,
        Start: f.d_but_de_lactivit,
        Finish: f.fin_de_lactivit
      }));

      const fig = {
        type: "timeline",
        x: tasks.map(t => [t.Start, t.Finish]),
        y: tasks.map(t => t.Task)
      };

      Plotly.newPlot("chart", [fig]);
    }

    loadData();
  </script>
</body>
</html>
